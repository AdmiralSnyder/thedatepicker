<!DOCTYPE html>
<html lang="en-US">
<head>
		<meta charset="utf-8">
		<title>The Datepicker</title>
		<meta name="Keywords" content="javascript,datepicker">
		<meta name="Description" content="Pure JavaScript Datepicker">
		<link rel="stylesheet" href="dist/the-datepicker.css">
		<script src="dist/the-datepicker.js"></script>
		<style>
			article {
				float: left;
			}
			#label-wrapper {
				float: left;
			}
			#input-wrapper {
				float: left;
				margin-left: 10px;
			}
			aside {
				float: left;
				clear: left;
				margin-top: 265px;
			}
			.settings {
				font-family: "Courier New", serif;
				list-style: none;
				padding-left: 0;
			}
			.invalid {
				background: #fdd;
			}
		</style>
</head>
<body>
	<main>
		<article>
			<div id="label-wrapper">
				<label for="my-input">Date:</label>
			</div>
			<div id="input-wrapper">
				<input type="text" id="my-input" size="20">
			</div>
		</article>

		<aside>
			<ul class="settings">
				<li>
					var datepicker = new TheDatepicker.Datepicker(document.getElementById('my-input'));
				</li>
				<li>
					<label>datepicker.options.setInitialDate(<input type="text" size="15" id="initialDate">);</label>
				</li>
				<li>
					<label>datepicker.options.setInitialMonth(<input type="text" size="15" id="initialMonth">);</label>
				</li>
				<li>
					datepicker.<input type="button" id="open" value="open()">;
				</li>
				<li>
					datepicker.<input type="button" id="close" value="close()">;
				</li>
				<li>
					<label>datepicker.options.setHideOnBlur(<input type="checkbox" id="hideOnBlur" checked="checked">);</label>
				</li>
				<li>
					<label>datepicker.options.setInputFormat(<input type="text" size="15" id="inputFormat" value="j. n. Y">);</label>
				</li>
				<li>
					<label>datepicker.options.setMinDate(<input type="text" size="15" id="minDate">);</label>
				</li>
				<li>
					<label>datepicker.options.setMaxDate(<input type="text" size="15" id="maxDate">);</label>
				</li>
				<li>
					<label>datepicker.options.setYearsSelectionLimits(<input type="text" size="8" id="yearsSelectionLimitsFrom" value="1900">, <input type="text" size="8" id="yearsSelectionLimitsTo" value="2100">);</label>
				</li>
				<li>
					<label>datepicker.options.setDaysOutOfMonthVisible(<input type="checkbox" id="daysOutOfMonthVisible">);</label>
				</li>
				<li>
					<label>datepicker.options.setFixedRowsCount(<input type="checkbox" id="fixedRowsCount">);</label>
				</li>
				<li>
					<label>datepicker.options.setToggleSelection(<input type="checkbox" id="toggleSelection">);</label>
				</li>
				<li>
					<label>datepicker.options.setShowDeselectButton(<input type="checkbox" id="showDeselectButton" checked="checked">);</label>
				</li>
				<li>
					<label>datepicker.options.setAllowEmpty(<input type="checkbox" id="allowEmpty" checked="checked">);</label>
				</li>
				<li>
					<label>datepicker.options.setShowCloseButton(<input type="checkbox" id="showCloseButton" checked="checked">);</label>
				</li>
				<li>
					<label>datepicker.options.setShowResetButton(<input type="checkbox" id="showResetButton" checked="checked">);</label>
				</li>
				<li>
					<label>datepicker.options.setDateAvailabilityResolver((date) => {<br>
						&nbsp;<textarea rows="3" cols="40" id="dateAvailabilityResolver">return true;</textarea><br>
						});</label>
				</li>
				<li>
					<label>datepicker.options.setCellContentResolver((day) => {<br>
						&nbsp;<textarea rows="3" cols="40" id="cellContentResolver">return day.dayNumber;</textarea><br>
						});</label>
				</li>
				<li>
					<label>datepicker.options.onBeforeSelect((event, day, previousDay) => {<br>
						&nbsp;<textarea rows="3" cols="40" id="onBeforeSelect"></textarea><br>
						});</label>
				</li>
				<li>
					<label>datepicker.options.onSelect((event, day, previousDay) => {<br>
						&nbsp;<textarea rows="3" cols="40" id="onSelect"></textarea><br>
					});</label>
				</li>
				<li>
					<label>datepicker.options.onBeforeSwitch((event, isOpening) => {<br>
						&nbsp;<textarea rows="3" cols="40" id="onBeforeSwitch"></textarea><br>
						});</label>
				</li>
				<li>
					<label>datepicker.options.onSwitch((event, isOpening) => {<br>
						&nbsp;<textarea rows="3" cols="40" id="onSwitch"></textarea><br>
					});</label>
				</li>
				<li>
					<label>datepicker.options.onBeforeGo((event, month, previousMonth) => {<br>
						&nbsp;<textarea rows="3" cols="40" id="onBeforeGo"></textarea><br>
						});</label>
				</li>
				<li>
					<label>datepicker.options.onGo((event, month, previousMonth) => {<br>
						&nbsp;<textarea rows="3" cols="40" id="onGo"></textarea><br>
					});</label>
				</li>
				<li>
					datepicker.render();
				</li>
			</ul>
		</aside>
	</main>

	<script>
		(function () {
			var input = document.getElementById('my-input');

			var datepicker = new TheDatepicker.Datepicker(input);
			datepicker.render();

			var updateSetting = function (settingInput, callback) {
				settingInput.className = '';
				try {
					callback();
					datepicker.render();
				} catch (error) {
					console.error(error);
					settingInput.className = 'invalid';
				}
			};

			var createCallback = function (argumentsString, body) {
				var wrap = function () {
					return '{ return function( ' + argumentsString + ' ){ ' + body + ' } };'
				};
				return (new Function(wrap()))();
			};

			var updateListener = function(eventName, body, argumentsString) {
				eventName = eventName.charAt(0).toUpperCase() + eventName.slice(1);

				datepicker.options['off' + eventName]();

				if (body === '') {
					return;
				}

				datepicker.options['on' + eventName](createCallback(argumentsString, body));
			};

			var initialDateInput = document.getElementById('initialDate');
			initialDateInput.onchange = function () {
				updateSetting(initialDateInput, function () {
					datepicker.options.setInitialDate(initialDateInput.value !== '' ? initialDateInput.value : null);
				});
			};

			var initialMonthInput = document.getElementById('initialMonth');
			initialMonthInput.onchange = function () {
				updateSetting(initialMonthInput, function () {
					datepicker.options.setInitialMonth(initialMonthInput.value !== '' ? initialMonthInput.value : null);
				});
			};

			var openInput = document.getElementById('open');
			openInput.onclick = function () {
				datepicker.open();
			};

			var closeInput = document.getElementById('close');
			closeInput.onclick = function () {
				datepicker.close();
			};

			var hideOnBlurInput = document.getElementById('hideOnBlur');
			hideOnBlurInput.onchange = function () {
				updateSetting(hideOnBlurInput, function () {
					datepicker.options.setHideOnBlur(hideOnBlurInput.checked);
				});
			};

			var inputFormatInput = document.getElementById('inputFormat');
			inputFormatInput.onchange = function () {
				updateSetting(inputFormatInput, function () {
					datepicker.options.setInputFormat(inputFormatInput.value);
				});
			};

			var minDateInput = document.getElementById('minDate');
			minDateInput.onchange = function () {
				updateSetting(minDateInput, function () {
					datepicker.options.setMinDate(minDateInput.value !== '' ? minDateInput.value : null);
				});
			};

			var maxDateInput = document.getElementById('maxDate');
			maxDateInput.onchange = function () {
				updateSetting(maxDateInput, function () {
					datepicker.options.setMaxDate(maxDateInput.value !== '' ? maxDateInput.value : null);
				});
			};

			var yearsSelectionLimitsFromInput = document.getElementById('yearsSelectionLimitsFrom');
			var yearsSelectionLimitsToInput = document.getElementById('yearsSelectionLimitsTo');
			var yearsSelectionLimitsOnChange = function () {
				yearsSelectionLimitsFromInput.className = '';
				yearsSelectionLimitsToInput.className = '';
				try {
					datepicker.options.setYearsSelectionLimits(parseInt(yearsSelectionLimitsFromInput.value, 10), parseInt(yearsSelectionLimitsToInput.value, 10));
					datepicker.render();
				} catch (error) {
					console.error(error);
					yearsSelectionLimitsFromInput.className = 'invalid';
					yearsSelectionLimitsToInput.className = 'invalid';
				}
			};
			yearsSelectionLimitsFromInput.onchange = yearsSelectionLimitsOnChange;
			yearsSelectionLimitsToInput.onchange = yearsSelectionLimitsOnChange;

			var daysOutOfMonthVisibleInput = document.getElementById('daysOutOfMonthVisible');
			daysOutOfMonthVisibleInput.onchange = function () {
				updateSetting(daysOutOfMonthVisibleInput, function () {
					datepicker.options.setDaysOutOfMonthVisible(daysOutOfMonthVisibleInput.checked);
				});
			};

			var fixedRowsCountInput = document.getElementById('fixedRowsCount');
			fixedRowsCountInput.onchange = function () {
				updateSetting(fixedRowsCountInput, function () {
					datepicker.options.setFixedRowsCount(fixedRowsCountInput.checked);
				});
			};

			var toggleSelectionInput = document.getElementById('toggleSelection');
			toggleSelectionInput.onchange = function () {
				updateSetting(toggleSelectionInput, function () {
					datepicker.options.setToggleSelection(toggleSelectionInput.checked);
				});
			};

			var showDeselectButtonInput = document.getElementById('showDeselectButton');
			showDeselectButtonInput.onchange = function () {
				updateSetting(showDeselectButtonInput, function () {
					datepicker.options.setShowDeselectButton(showDeselectButtonInput.checked);
				});
			};

			var allowEmptyInput = document.getElementById('allowEmpty');
			allowEmptyInput.onchange = function () {
				updateSetting(allowEmptyInput, function () {
					datepicker.options.setAllowEmpty(allowEmptyInput.checked);
				});
			};

			var showCloseButtonInput = document.getElementById('showCloseButton');
			showCloseButtonInput.onchange = function () {
				updateSetting(showCloseButtonInput, function () {
					datepicker.options.setShowCloseButton(showCloseButtonInput.checked);
				});
			};

			var showResetButtonInput = document.getElementById('showResetButton');
			showResetButtonInput.onchange = function () {
				updateSetting(showResetButtonInput, function () {
					datepicker.options.setShowResetButton(showResetButtonInput.checked);
				});
			};

			var dateAvailabilityResolverInput = document.getElementById('dateAvailabilityResolver');
			dateAvailabilityResolverInput.onchange = function () {
				if (dateAvailabilityResolverInput.value === '') {
					datepicker.options.setDateAvailabilityResolver(null);
				} else {
					datepicker.options.setDateAvailabilityResolver(createCallback('date', dateAvailabilityResolverInput.value));
				}
				datepicker.render();
			};

			var cellContentResolverInput = document.getElementById('cellContentResolver');
			cellContentResolverInput.onchange = function () {
				if (cellContentResolverInput.value === '') {
					datepicker.options.setCellContentResolver(null);
				} else {
					datepicker.options.setCellContentResolver(createCallback('day', cellContentResolverInput.value));
				}
				datepicker.render();
			};

			var onBeforeSelectInput = document.getElementById('onBeforeSelect');
			onBeforeSelectInput.onchange = function () {
				updateListener('beforeSelect', onBeforeSelectInput.value, 'event, day, previousDay');
			};

			var onSelectInput = document.getElementById('onSelect');
			onSelectInput.onchange = function () {
				updateListener('select', onSelectInput.value, 'event, day, previousDay');
			};

			var onBeforeSwitchInput = document.getElementById('onBeforeSwitch');
			onBeforeSwitchInput.onchange = function () {
				updateListener('beforeSwitch', onBeforeSwitchInput.value, 'event, isOpening');
			};

			var onSwitchInput = document.getElementById('onSwitch');
			onSwitchInput.onchange = function () {
				updateListener('switch', onSwitchInput.value, 'event, isOpening');
			};

			var onBeforeGoInput = document.getElementById('onBeforeGo');
			onBeforeGoInput.onchange = function () {
				updateListener('beforeGo', onBeforeGoInput.value, 'event, month, previousMonth');
			};

			var onGoInput = document.getElementById('onGo');
			onGoInput.onchange = function () {
				updateListener('go', onGoInput.value, 'event, month, previousMonth');
			};
		})();
	</script>
</body>
</html>
